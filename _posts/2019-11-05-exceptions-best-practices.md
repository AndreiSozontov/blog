---
layout: post
title: Exceptions - стратегия обработки исключений
description: Что такое исключения, best-practices по обработке исключений
summary: Что такое исключения, best-practices по обработке исключений
comments: true
tags: [csharp, best_practices]
---

# Основные понятия

**Исключения** - это ошибки, возникшие в runtime (во время выполнения программы), а не на стадии компиляции.
**Исключения** - это специальное средство, позволяющее передать в вызывающий код возникшие ошибки и исключительные ситуации.

Принцип такой: метод, сталкиваясь с неожиданной ситуацией, которую он не может обработать, применяя оператор `throw`, создает объект-исключение. Код в методе, стоящего выше в иерархии вызовов, перехватит это исключение в блоке `try`-`catch`

В блоке try помещается код, который может прерваться из-за исключения, а затем продолжиться в секции catch. 
В блок catch помещают код, который должен выполняться в ответ на исключение. Если в блоке try не произошло исключений CLR не перейдет к выполнению кода в блоке catch.
Код блока finally выполняется всегда. Обычно этот код производит очистку после выполнения блока try

# Стратегия обработки исключений и best-practices

Исключения следует использовать в случаях, чтобы устранить ситуации, когда важная ошибка может остаться незамеченной.

- Вносите в описание исключения всю информацию о его причинах
- Не используйте исключения по мелочам. Старайтесь по возможности (если это не дорого) проверять предусловия **tester-doer pattern**, чтобы избежать проблем производительности, связанных с исключениями. При проектировании класса необходимо обеспечить пользователям возможность писать код не генерирующий исключения.
- Рассмотрите boolean **шаблон Try-Parse** для членов, которые могут генерировать исключения в частых сценариях, чтобы избежать проблем производительности, связанных с исключениями. 
- **Не** генерируйте общие исключения _Exception_, _SystemException_, _ApplicationException_
- **Не** генерируйте зарезервированные платформой исключения NullReferenceException, IndexOutOfRangeException,  AccessViolationException, OutOfMemoryException
- Можно генерировать _ArgumentException_, _ArgumentNullException_, _ArgumentOutOfRangeException_, указывайте в конструкторе имя аргумента.
- Можно генерировать _InvalidOperationException_ если объект в неподходящем состоянии 

# Возможные вопросы

В чем разница между **throw** и **throw ex**?
**throw** пробрасывает исключение выше, сохраняя _StackTrace_. **throw ex** тоже пробрасывает исключение выше, но сбрасывает _StackTrace_ к текущему методу.